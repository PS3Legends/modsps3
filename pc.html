<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Game Mods - PC View</title>
  <meta name="description" content="Wide screen PC version of Game Mods Hub" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />

  <script>
    if (window.innerWidth < 1000) {
      location.href = "index.html";
    }
  </script>
</head>
<body>
  <header class="main-header">
    <h1>Game Mods - PC View</h1>
    <p>Optimized for large screens</p>
    <button id="darkModeToggle" aria-label="Toggle Dark Mode">Toggle Dark Mode</button>
  </header>

  <div class="search-container">
    <div class="search-box">
      <input type="search" id="search" placeholder="Search by game name..." />
    </div>
  </div>

  <section class="pc-mods-list" id="mods-list">
    <div id="loading-message" class="loading-message">
      <div class="loading-indicator"></div>
      <p>Loading mods...</p>
    </div>
    <p id="no-mods-message">No mods found.</p>
  </section>

  <footer class="footer">
    <p>&copy; 2025 Game Mods Hub.</p>
    <div class="footer-links">
      <a href="privacy.html">Privacy</a>
      <a href="terms.html">Terms</a>
      <a href="contact.html">Contact</a>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let modsData = [];
      let searchQuery = '';

      const modsList = document.getElementById('mods-list');
      const searchInput = document.getElementById('search');
      const loadingMessage = document.getElementById('loading-message');
      const noModsMessage = document.getElementById('no-mods-message');
      const darkModeToggle = document.getElementById('darkModeToggle');

      if (localStorage.getItem('darkMode') === 'enabled') {
        document.body.classList.add('dark-mode');
      }

      darkModeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        if (document.body.classList.contains('dark-mode')) {
          localStorage.setItem('darkMode', 'enabled');
        } else {
          localStorage.removeItem('darkMode');
        }
      });

      searchInput.addEventListener('input', debounce(searchMods, 300));

      fetchModsData();

      function debounce(func, wait) {
        let timeout;
        return function (...args) {
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(this, args), wait);
        };
      }

      async function fetchModsData() {
        try {
          loadingMessage.style.display = 'flex';
          const response = await fetch('mods.json');
          if (!response.ok) throw new Error('Failed to load mods');
          modsData = await response.json();
          renderMods();
        } catch (error) {
          modsList.innerHTML = `<div class="error">Failed to load mods.</div>`;
        } finally {
          loadingMessage.style.display = 'none';
        }
      }

      function searchMods() {
        searchQuery = searchInput.value.trim().toLowerCase();
        renderMods();
      }

      function filterMods() {
        if (!searchQuery) return modsData;
        return modsData.filter(mod => mod.game && mod.game.toLowerCase().includes(searchQuery));
      }

      function renderMods() {
        const filteredMods = filterMods();
        modsList.innerHTML = '';

        if (filteredMods.length === 0) {
          noModsMessage.style.display = 'block';
          return;
        }

        noModsMessage.style.display = 'none';

        filteredMods.forEach(mod => {
          modsList.appendChild(createModElement(mod));
        });
      }

      function createModElement(mod) {
        const versions = mod.versions || {};
        const versionKeys = Object.keys(versions);
        const hasVersions = versionKeys.length > 0 && versionKeys.some(v => versions[v]);
        const hasAnyPreview = mod.modImage1 || mod.modImage2;

        const modElement = document.createElement('div');
        modElement.classList.add('pc-mod-item');

        modElement.innerHTML = `
          <div class="mod-info">
            <h3 class="game-name">${mod.game || 'Unknown Game'}</h3>
            <h2 class="mod-title">${escapeHtml(mod.title || 'Untitled Mod')}</h2>
            ${hasAnyPreview ? `
            <div class="open-preview-wrapper">
              <span class="open-label">Open:</span>
              <div class="open-preview">
                ${mod.modImage1 ? `<img src="${mod.modImage1}" loading="lazy" class="open-img left">` : ''}
                <img src="icons-buttons/plus.png" class="open-img center">
                ${mod.modImage2 ? `<img src="${mod.modImage2}" loading="lazy" class="open-img right">` : ''}
              </div>
            </div>` : ''}
          </div>
          ${hasVersions ? `
          <div class="version-select">
            <select>
              ${versionKeys.map(v => versions[v] ? `<option value="${versions[v]}">${v} ${mod.fileSize ? `(${mod.fileSize})` : ''}</option>` : '').join('')}
            </select>
          </div>` : '<p class="no-versions">Coming Soon</p>'}
          <div class="mod-footer">
            <small>Author: ${mod.author || 'Unknown'}</small>
          </div>
          <a href="${hasVersions && versions[versionKeys[0]] ? versions[versionKeys[0]] : '#'}"
            class="download-btn ${!hasVersions || !versions[versionKeys[0]] ? 'disabled-link' : ''}"
            ${!hasVersions || !versions[versionKeys[0]] ? 'tabindex="-1" aria-disabled="true"' : ''}>
            ${hasVersions && versions[versionKeys[0]] ? "Download Now" : "Coming Soon"}
          </a>
        `;

        const select = modElement.querySelector('select');
        if (select) {
          select.addEventListener('change', (e) => {
            const downloadBtn = modElement.querySelector('.download-btn');
            downloadBtn.href = e.target.value;
          });
        }

        return modElement;
      }

      function escapeHtml(text) {
        return text ? text.toString()
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;") : '';
      }
    });
  </script>
</body>
</html>